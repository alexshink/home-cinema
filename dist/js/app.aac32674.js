(function(){"use strict";var t={1756:function(t,i,e){var n=e(9242),o=e(3396),a=e(7139),s=e.p+"img/logo.cd294876.jpg";const l={class:"container"},r=(0,o._)("img",{alt:"Home Cinema",src:s,class:"page__logo"},null,-1),u={key:0,class:"page__inner"},c={key:1,class:"page__inner"},d={key:0,class:"footer"},m={class:"container"},h={class:"user-email"};function f(t,i,e,n,s,f){const _=(0,o.up)("FilmView");return(0,o.wg)(),(0,o.iD)("div",{class:(0,a.C_)(["page",{"page_auth-loading":s.authLoading}])},[(0,o._)("div",l,[r,s.activeUserFilmList?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",u,[(0,o._)("button",{type:"button",class:"button",onClick:i[0]||(i[0]=t=>f.loadFilms("Нэйт"))},"Нэйт"),(0,o._)("button",{type:"button",class:"button",onClick:i[1]||(i[1]=t=>f.loadFilms("Алекс"))},"Алекс")])),s.activeUserFilmList?((0,o.wg)(),(0,o.iD)("div",c,[s.activeUserFilmList?((0,o.wg)(),(0,o.j4)(_,{key:0,author:s.activeUserFilmList},null,8,["author"])):(0,o.kq)("",!0),(0,o._)("button",{type:"button",class:"button button_theme_secondary",onClick:i[2]||(i[2]=(...t)=>f.goBack&&f.goBack(...t))},"Назад")])):(0,o.kq)("",!0)]),s.currentUser?((0,o.wg)(),(0,o.iD)("footer",d,[(0,o._)("div",m,[(0,o._)("div",h,(0,a.zw)(s.currentUser?.email),1)])])):(0,o.kq)("",!0)],2)}const _=t=>((0,o.dD)("data-v-3100cffe"),t=t(),(0,o.Cn)(),t),g={key:0,class:"film-box"},p={key:0},w={key:1,class:"film-box__inner"},v=_((()=>(0,o._)("p",null,"Фильмы загружены, пора сделать выбор!",-1))),b={class:"film-box__info"},y={class:"film-box__item-title"},k={class:"film-box__item-poster"},F=["src"],U={class:"film-box__actions"},C={key:1,type:"button",disabled:"",class:"button"},P={key:2,class:"modal"},L={key:1,class:"modal"};function x(t,i,e,s,l,r){return(0,o.wg)(),(0,o.iD)("div",{class:(0,a.C_)(["film-view",{"film-view_loading":l.loading}])},[l.loading?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",g,[l.filmList.length?((0,o.wg)(),(0,o.iD)("div",w,[l.currentRandomFilm?((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.wy)((0,o._)("div",{class:(0,a.C_)(["film-box__item",{"film-box__item_viewed":l.currentRandomFilm.viewed}])},[(0,o._)("h1",y,(0,a.zw)(l.currentRandomFilm.name),1),(0,o._)("div",k,[l.currentRandomFilm.poster?((0,o.wg)(),(0,o.iD)("img",{key:0,class:"film-box__item-image",src:l.currentRandomFilm.poster,alt:""},null,8,F)):(0,o.kq)("",!0)])],2),[[n.F8,!t.changeFilm]]),(0,o._)("div",U,[l.currentRandomFilm.viewed?((0,o.wg)(),(0,o.iD)("button",C,"Уже просмотрен!")):((0,o.wg)(),(0,o.iD)("button",{key:0,type:"button",class:"button",onClick:i[1]||(i[1]=t=>r.setAlreadyViewed())},"Смотрим этот!")),(0,o._)("button",{type:"button",class:"button",onClick:i[2]||(i[2]=t=>r.getRandomFilm())},"Другой ›")])],64)):((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[v,(0,o._)("div",b,[(0,o._)("div",null,[(0,o.Uk)("Фильмов в списке: "),(0,o._)("i",null,(0,a.zw)(l.filmList.length),1)]),(0,o._)("div",null,[(0,o.Uk)("Всего посмотрено: "),(0,o._)("i",null,(0,a.zw)(r.viewedFilmsLength),1)])]),(0,o._)("button",{type:"button",class:"button",onClick:i[0]||(i[0]=t=>r.getRandomFilm())},"Погнали!")],64))])):((0,o.wg)(),(0,o.iD)("p",p,"Дэээмн, в этом списке пока нет фильмов, го добавлять!")),(0,o._)("button",{type:"button",class:"button button_theme_secondary",onClick:i[3]||(i[3]=t=>l.currentUser?l.showAddModal=!0:l.showAuthModal=!0)},"Добавить фильм"),l.showAddModal?((0,o.wg)(),(0,o.iD)("div",P,[(0,o._)("div",{class:(0,a.C_)(["modal__form",{modal__form_loading:l.addInProgress}])},[(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":i[4]||(i[4]=t=>l.filmName=t),placeholder:"Название фильма"},null,512),[[n.nr,l.filmName]]),(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":i[5]||(i[5]=t=>l.filmPoster=t),placeholder:"Ссылка на постер"},null,512),[[n.nr,l.filmPoster]]),(0,o._)("button",{type:"button",class:"button modal__form-submit",onClick:i[6]||(i[6]=t=>r.addFilm())},"Отправить"),(0,o._)("button",{type:"button",class:"button modal__form-close",onClick:i[7]||(i[7]=t=>l.showAddModal=!1)})],2)])):(0,o.kq)("",!0)])),l.showAuthModal?((0,o.wg)(),(0,o.iD)("div",L,[(0,o._)("div",{class:(0,a.C_)(["modal__form",{modal__form_loading:l.signInProgress}])},[(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":i[8]||(i[8]=t=>l.authEmail=t),placeholder:"Email"},null,512),[[n.nr,l.authEmail]]),(0,o.wy)((0,o._)("input",{type:"password","onUpdate:modelValue":i[9]||(i[9]=t=>l.authPassword=t),placeholder:"Пароль"},null,512),[[n.nr,l.authPassword]]),(0,o._)("button",{type:"button",class:"button modal__form-submit",onClick:i[10]||(i[10]=t=>r.signIn())},"Войти"),(0,o._)("button",{type:"button",class:"button modal__form-close",onClick:i[11]||(i[11]=t=>l.showAuthModal=!1)})],2)])):(0,o.kq)("",!0)],2)}e(560);var A=e(4287),D=e(7795);const I=(0,D.ZF)({apiKey:"AIzaSyBBi-qazeRwtQ223P0Gfm01uiflzvjvSxk",authDomain:"home-cinema-28af0.firebaseapp.com",projectId:"home-cinema-28af0",storageBucket:"home-cinema-28af0.appspot.com",messagingSenderId:"642870991425",appId:"1:642870991425:web:05c0f861395d9758fec4c0",measurementId:"G-D7CZHB9FZY"}),R=(0,A.ad)(I);var M=e(4672),O={name:"FilmView",props:{author:{required:!0,type:String,validator(t){return["Нэйт","Алекс"].includes(t)}}},data(){return{filmList:[],loading:!0,currentRandomFilm:null,currentUser:(0,M.v0)().currentUser,showAuthModal:!1,authEmail:"",authPassword:"",signInProgress:!1,showAddModal:!1,filmName:"",filmPoster:"",addInProgress:!1}},computed:{viewedFilmsLength(){return this.filmList.filter((t=>t.viewed)).length}},methods:{async getRandomFilm(){const t=Math.floor(Math.random()*this.filmList.length);this.currentRandomFilm=null,this.changeFilm=!0,await(0,o.Y3)(),this.changeFilm=!1,this.currentRandomFilm=this.filmList[t]},async setAlreadyViewed(){if(this.checkAuth())try{await(0,A.r7)((0,A.JU)(R,"films",this.currentRandomFilm.id),{viewed:!0}),this.currentRandomFilm.viewed=!0}catch(t){alert(t)}},async addFilm(){if(this.filmName){this.addInProgress=!0;try{await(0,A.ET)((0,A.hJ)(R,"films"),{name:this.filmName,author:this.author,poster:this.filmPoster,viewed:!1}),await this.loadFilms(),this.showAddModal=!1}catch(t){alert(t)}finally{this.addInProgress=!1}}},signIn(){this.authEmail&&this.authPassword&&(this.signInProgress=!0,(0,M.e5)((0,M.v0)(),this.authEmail,this.authPassword).then((t=>{this.currentUser=t.user,this.showAuthModal=!1})).catch((t=>{console.log(t)})).finally((()=>{this.signInProgress=!1})))},logOut(){const t=(0,M.v0)();(0,M.w7)(t).then((()=>{window.location.reload()})).catch((t=>{console.log(t)}))},checkAuth(){return!!this.currentUser||(this.showAuthModal=!0,!1)},async loadFilms(){this.loading=!0;try{const t=(0,A.IO)((0,A.hJ)(R,"films"),(0,A.ar)("author","==",this.author)),i=await(0,A.PL)(t);i.forEach((t=>{const i=t.data();i.id=t.id,this.filmList.push(i)}))}catch(t){console.log(t)}finally{this.loading=!1}}},mounted(){this.loadFilms()}},j=e(89);const q=(0,j.Z)(O,[["render",x],["__scopeId","data-v-3100cffe"]]);var E=q,V={name:"App",components:{FilmView:E},data(){return{films:[],activeUserFilmList:null,currentUser:null,authLoading:!0}},methods:{loadFilms(t){this.activeUserFilmList=t},goBack(){this.activeUserFilmList=null}},async mounted(){const t=(0,M.v0)();(0,M.Aj)(t,(t=>{t&&(this.currentUser=t),this.authLoading=!1}))}};const z=(0,j.Z)(V,[["render",f]]);var B=z;(0,n.ri)(B).mount("#app")}},i={};function e(n){var o=i[n];if(void 0!==o)return o.exports;var a=i[n]={exports:{}};return t[n].call(a.exports,a,a.exports,e),a.exports}e.m=t,function(){var t=[];e.O=function(i,n,o,a){if(!n){var s=1/0;for(c=0;c<t.length;c++){n=t[c][0],o=t[c][1],a=t[c][2];for(var l=!0,r=0;r<n.length;r++)(!1&a||s>=a)&&Object.keys(e.O).every((function(t){return e.O[t](n[r])}))?n.splice(r--,1):(l=!1,a<s&&(s=a));if(l){t.splice(c--,1);var u=o();void 0!==u&&(i=u)}}return i}a=a||0;for(var c=t.length;c>0&&t[c-1][2]>a;c--)t[c]=t[c-1];t[c]=[n,o,a]}}(),function(){e.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(i,{a:i}),i}}(),function(){e.d=function(t,i){for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)}}(),function(){e.p="/home-cinema/"}(),function(){var t={143:0};e.O.j=function(i){return 0===t[i]};var i=function(i,n){var o,a,s=n[0],l=n[1],r=n[2],u=0;if(s.some((function(i){return 0!==t[i]}))){for(o in l)e.o(l,o)&&(e.m[o]=l[o]);if(r)var c=r(e)}for(i&&i(n);u<s.length;u++)a=s[u],e.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return e.O(c)},n=self["webpackChunkhome_cinema"]=self["webpackChunkhome_cinema"]||[];n.forEach(i.bind(null,0)),n.push=i.bind(null,n.push.bind(n))}();var n=e.O(void 0,[998],(function(){return e(1756)}));n=e.O(n)})();
//# sourceMappingURL=app.aac32674.js.map